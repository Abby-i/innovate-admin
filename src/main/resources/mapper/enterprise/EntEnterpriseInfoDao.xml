<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.innovate.modules.enterprise.dao.EntEnterpriseInfoDao">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.innovate.modules.enterprise.entity.EntEnterpriseInfoEntity" id="entEnterpriseInfoMap">
        <result property="entInfoId" column="ent_info_id"/>
        <result property="userId" column="user_id"/>
        <result property="entName" column="ent_name"/>
        <result property="entCorporate" column="ent_corporate"/>
        <result property="entBusiness" column="ent_business"/>
        <result property="entCode" column="ent_code"/>
        <result property="entRegister" column="ent_register"/>
        <result property="entFoundingTime" column="ent_founding_time"/>
        <result property="entType" column="ent_type"/>
        <result property="entStatus" column="ent_status"/>
        <result property="entRegisterAddress" column="ent_register_address"/>
        <result property="entAddress" column="ent_address"/>
        <result property="entIntroduce" column="ent_introduce"/>
        <result property="newHighZones" column="new_high_zones"/>
        <result property="entInTime" column="ent_in_time"/>
        <result property="inApply" column="in_apply"/>
    </resultMap>



    <!-- 企业信息详情 -->
    <resultMap id="entEnterpriseInfo_attachment_Map" type="com.innovate.modules.enterprise.entity.EntEnterpriseInfoEntity" extends="entEnterpriseInfoMap">
        <collection property="attachments" ofType="com.innovate.modules.enterprise.entity.EntEnterpriseAttachmentEntity">
            <id column="ent_attachment_id" property="entAttachmentId" />
            <result column="pro_info_id" property="proInfoId" />
            <result column="pro_cooperation_info_id" property="proCooperationInfoId" />
            <result column="recruitment_info_id" property="recruitmentInfoId" />
            <result column="patent_info_id" property="patentInfoId" />
            <result column="ent_attachment_url" property="entAttachmentUrl" />
        </collection>
    </resultMap>
    <select id="queryEntEnterpriseInfo" resultMap="entEnterpriseInfo_attachment_Map">
        SELECT
            e_e_i.ent_info_id, e_e_i.user_id , e_e_i.ent_name , e_e_i.ent_corporate , e_e_i.ent_business , e_e_i.ent_code,
            e_e_i.ent_register, e_e_i.ent_founding_time, e_e_i.ent_type, e_e_i.ent_status ,e_e_i.ent_register_address ,
            e_e_i.ent_address ,e_e_i.ent_introduce, e_e_i.new_high_zones, e_e_i.ent_logo, e_e_i.ent_in_time, e_e_i.in_apply,
            e_e_a.ent_attachment_id, e_e_a.pro_info_id, e_e_a.pro_cooperation_info_id, e_e_a.recruitment_info_id, e_e_a.patent_info_id,
            e_e_a.ent_attachment_url
        FROM
            ent_enterprise_info e_e_i
        LEFT JOIN ent_enterprise_attachment e_e_a ON e_e_a.ent_info_id = e_e_i.ent_info_id
        WHERE
            e_e_i.ent_info_id = #{entInfoId}
            <if test="inApply != null and inApply != ''"> AND e_e_i.in_apply = #{inApply} </if>
    </select>

    <!-- 更新企业入驻状态 -->
    <update id="updateInApply" >
        UPDATE ent_enterprise_info SET in_apply = #{inApply} WHERE ent_info_id = #{entInfoId}
    </update>

</mapper>