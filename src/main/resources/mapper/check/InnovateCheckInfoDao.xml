<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.innovate.modules.check.dao.InnovateCheckInfoDao">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.innovate.modules.check.entity.InnovateCheckInfoEntity" id="innovateCheckInfoMap">
        <result property="checkId" column="check_id"/>
        <result property="declareId" column="declare_id"/>
        <result property="groupId" column="group_id"/>
        <result property="isUpdate" column="is_update"/>
        <result property="applyUpdate" column="apply_update"/>
        <result property="checkNoPass" column="check_no_pass"/>
        <result property="instituteId" column="institute_id"/>
        <result property="checkScoreAvg" column="check_score_avg"/>
        <result property="projectCheckApplyStatus" column="project_check_apply_status"/>
        <result property="checkTime" column="check_time"/>
        <result property="isDel" column="is_del"/>
    </resultMap>

    <select id="queryCountPage" resultType="Integer" parameterType="map">

        select count(*) from innovate_check_info a

        <if test="userId != null and userId != ''">
            inner join innovate_declare_info b on a.declare_id = b.declare_id
            and b.project_user_id = #{userId}
        </if>

        where 1 = 1

        <if test="declareId != null and declareId != ''">
            and a.declare_id = #{declareId}
        </if>

        <if test="groupId != null and groupId != ''">
            and a.group_id = #{groupId}
        </if>

        <if test="isUpdate != null and isUpdate != ''">
            and a.is_update = #{isUpdate}
        </if>

        <if test="applyUpdate != null and applyUpdate != ''">
            and a.apply_update = #{applyUpdate}
        </if>

        <if test="checkNoPass != null and checkNoPass != ''">
            and a.check_no_pass = #{checkNoPass}
        </if>

        <if test="instituteId != null and instituteId != ''">
            and a.institute_id = #{instituteId}
        </if>

        <if test="projectCheckApplyStatus != null and projectCheckApplyStatus != ''">
            and a.project_check_apply_status = #{projectCheckApplyStatus}
        </if>

        <if test="checkTime != null and checkTime != ''">
            and a.check_time like CONCAT('%',#{checkTime},'%')
        </if>

        <if test="isDel != null and isDel != ''">
            and a.is_del = #{isDel}
        </if>
    </select>

    <select id="queryPage" parameterType="map" resultType="InnovateCheckInfoEntity">

        select * from innovate_check_info a

        <if test="userId != null and userId != ''">
            inner join innovate_declare_info b on a.declare_id = b.declare_id
            and b.project_user_id = #{userId}
        </if>

        where 1 = 1

        <if test="declareId != null and declareId != ''">
                and a.declare_id = #{declareId}
        </if>

        <if test="groupId != null and groupId != ''">
            and a.group_id = #{groupId}
        </if>

        <if test="isUpdate != null and isUpdate != ''">
            and a.is_update = #{isUpdate}
        </if>

        <if test="applyUpdate != null and applyUpdate != ''">
            and a.apply_update = #{applyUpdate}
        </if>

        <if test="checkNoPass != null and checkNoPass != ''">
            and a.check_no_pass = #{checkNoPass}
        </if>

        <if test="instituteId != null and instituteId != ''">
            and a.institute_id = #{instituteId}
        </if>

        <if test="projectCheckApplyStatus != null and projectCheckApplyStatus != ''">
            and a.project_check_apply_status = #{projectCheckApplyStatus}
        </if>

        <if test="checkTime != null and checkTime != ''">
            and a.check_time like CONCAT('%',#{checkTime},'%')
        </if>

        <if test="isDel != null and isDel != ''">
            and a.is_del = #{isDel}
        </if>

        <if test="starPage != null and endPage != null">
            limit #{startPage}, #{endPage}
        </if>
    </select>

</mapper>